# Моделирование магнитного поля структуры

**Авторы:**  
- Агибалов Илья Станиславович (М3208)  
- Фасолько Александр Андреевич (М3208)  

## Цель задания
Рассчитать и визуализировать силовые линии магнитного поля, создаваемого постоянным магнитом произвольной формы.  

Обеспечить возможность выбора пользователем:
- Типов фигур: произвольный контур, прямоугольник, треугольник, окружность
- Расстановки полюсов (N/S)

## Физическая модель

### Модель магнитного заряда
Каждая точка-полюс моделируется как точечный магнитный монополь с зарядом:

$$
q_m = \begin{cases}
+1 & \text{(N полюс)} \\
-1 & \text{(S полюс)}
\end{cases}
$$

Магнитное поле в точке $\mathbf{r} = (x, y)$:

$$
\mathbf{B}_m (\mathbf{r}) = q_m \frac{\mathbf{r} - \mathbf{r}_m}{|\mathbf{r} - \mathbf{r}_m|^3}
$$

где:
- $\mathbf{r}_m = (x_m, y_m)$ - координаты монополя
- $|\mathbf{r} - \mathbf{r}_m|^3 = \left[(x-x_m)^2 + (y-y_m)^2 + \varepsilon\right]^{1.5}$
- $\varepsilon = 10^{-3}$ - предотвращяет разрыв в центре

### Суперпозиция полей
Суммарное поле:

$$
\mathbf{B}(x,y) = \sum_{m=1}^N \mathbf{B}_m(x,y)
$$

Компоненты поля:

$$
B_x(x,y) = \sum_{m=1}^N q_m \frac{x-x_m}{\left[(x-x_m)^2 + (y-y_m)^2 + \varepsilon\right]^{1.5}}
$$

$$
B_y(x,y) = \sum_{m=1}^N q_m \frac{y-y_m}{\left[(x-x_m)^2 + (y-y_m)^2 + \varepsilon\right]^{1.5}}
$$

### Нормировка
Модуль поля:

$$
M(x,y) = \sqrt{B_x^2(x,y) + B_y^2(x,y)}
$$

Нормированные компоненты:

$$
\hat{B}_x = \frac{B_x}{\max M}, \quad \hat{B}_y = \frac{B_y}{\max M}
$$

## UI

### Режимы работы:
- `free` - произвольный контур
- `rect` - прямоугольник
- `triangle` - треугольник 
- `circle` - окружность

### Управление:
1. Выбор типа фигуры
2. Расстановка полюсов (N/S) кликом внутри контура
3. Переключение полярности (цвета)
4. Запуск расчета кнопкой "Start"

## Реализация

### Дискретизация
Функция `sample_interior(points, spacing)`:
1. Строит регулярную сетку с шагом `spacing`
2. Отбирает точки внутри многоугольника
3. Назначает каждой точке заряд ближайшего полюса

## Вывод
Модель успешно аппроксимирует поле произвольного магнита суперпозицией точечных монополей.
